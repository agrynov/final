# DanIT Homework - Step Final

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –º—ñ—Å—Ç–∏—Ç—å –ø–æ–≤–Ω—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –¥–µ–ø–ª–æ—é Python –¥–æ–¥–∞—Ç–∫—É –Ω–∞ AWS EKS –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º ArgoCD –¥–ª—è GitOps.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

### 1. Backend —Å–µ—Ä–≤–µ—Ä (`app.py`)
- Flask –¥–æ–¥–∞—Ç–æ–∫, —è–∫–∏–π —Å–ª—É—Ö–∞—î –Ω–∞ –ø–æ—Ä—Ç—É 8080
- –ü–æ–≤–µ—Ä—Ç–∞—î IP –∞–¥—Ä–µ—Å—É –ø–æ–¥–∞ —Ç–∞ –∫–ª—ñ—î–Ω—Ç–∞
- –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏–º–æ–≥–∞–º –∑–∞–≤–¥–∞–Ω–Ω—è

### 2. Dockerfile
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Python 3.11-slim
- –í—Å—Ç–∞–Ω–æ–≤–ª—é—î Flask –∑ requirements.txt
- –ö–æ–ø—ñ—é—î —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î app.py

### 3. GitHub Actions (`.github/workflows/docker-build.yml`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –±—ñ–ª–¥ Docker –æ–±—Ä–∞–∑—É –ø—Ä–∏ push –¥–æ main –≥—ñ–ª–∫–∏
- –ü—É—à –æ–±—Ä–∞–∑—É –¥–æ Docker Hub
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GitHub Secrets –¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

### 4. Terraform –∫–æ–¥ –¥–ª—è EKS (`EKS/`)
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è EKS –∫–ª–∞—Å—Ç–µ—Ä–∞ –∑ –æ–¥–Ω–∏–º node group
- Nginx Ingress Controller
- External DNS –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è DNS
- ACM —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –¥–ª—è HTTPS
- ArgoCD –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### 5. Kubernetes –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏ (`k8s/`)
- `deployment.yaml` - Deployment –¥–ª—è –¥–æ–¥–∞—Ç–∫—É
- `service.yaml` - Service –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–æ–¥–∞—Ç–∫—É
- `ingress.yaml` - Ingress –¥–ª—è –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø—É

### 6. ArgoCD Application (`argocd-app.yaml`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π –¥–æ–¥–∞—Ç–∫—É –∑ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
- GitOps –ø—ñ–¥—Ö—ñ–¥ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### GitHub Secrets
–ù–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ secrets –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó:
- `DOCKERHUB_USERNAME` - —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ Docker Hub
- `DOCKERHUB_TOKEN` - —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É Docker Hub

### Terraform –∑–º—ñ–Ω–Ω—ñ
–í `EKS/terraform.tfvars`:
```hcl
region = "eu-central-1"
name = "agrynov"  # –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–≤–æ—î —ñ–º'—è
zone_name = "devops7.test-danit.com"  # –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–≤–æ—é –≥—Ä—É–ø—É
```

### DNS –¥–æ–º–µ–Ω–∏
- ArgoCD: `argocd.agrynov.devops7.test-danit.com`
- –î–æ–¥–∞—Ç–æ–∫: `app.agrynov.devops7.test-danit.com`

## –î–µ–ø–ª–æ–π

1. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è EKS –∫–ª–∞—Å—Ç–µ—Ä–∞:**
```bash
cd EKS
terraform init
terraform plan
terraform apply
```

2. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è kubectl:**
```bash
aws eks update-kubeconfig --region eu-central-1 --name agrynov
```

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É:**
```bash
kubectl get pods -n argocd
kubectl get applications -n argocd
```

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

1. **ArgoCD UI:** https://argocd.agrynov.devops7.test-danit.com
2. **–î–æ–¥–∞—Ç–æ–∫:** https://app.agrynov.devops7.test-danit.com

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è

- –ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É push –¥–æ main –≥—ñ–ª–∫–∏ GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
  - –ë—ñ–ª–¥–∏—Ç—å –Ω–æ–≤–∏–π Docker –æ–±—Ä–∞–∑
  - –ü—É—à–∏—Ç—å –π–æ–≥–æ –¥–æ Docker Hub
- ArgoCD –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
  - –í—ñ–¥—Å—Ç–µ–∂—É—î –∑–º—ñ–Ω–∏ –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó
  - –î–µ–ø–ª–æ—ó—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–æ–¥–∞—Ç–∫—É –Ω–∞ EKS

## –§–æ—Ä–º–∞—Ç –∑–¥–∞—á—ñ

1. ‚úÖ –ö–æ–¥ backend —Å–µ—Ä–≤–µ—Ä–∞ (–ø–µ—Ä–µ–¥–∞—î IP –∞–¥—Ä–µ—Å—É –ø–æ–¥–∞)
2. ‚úÖ –ö–æ–¥ Dockerfile
3. ‚úÖ –ö–æ–¥ GitHub Actions –ø–∞–π–ø–ª–∞–π–Ω—É
4. ‚úÖ –ö–æ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞, nginx controller, etc.
5. ‚úÖ –ö–æ–¥ –ø—ñ–¥–Ω—è—Ç—Ç—è ArgoCD
6. ‚úÖ –ö–æ–¥ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
7. üì∏ –°–∫—Ä—ñ–Ω–∏ —Ä–æ–±–æ—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞, –Ω–µ–π–º—Å–ø–µ–π—Å—ñ–≤, —Ä–æ–±–æ—Ç–∏ ArgoCD, –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó ArgoCD, –∑–º—ñ–Ω–∏ —ñ–º–µ–¥–∂—ñ–≤ –≤ Docker Hub
8. üì∏ –°–∫—Ä—ñ–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –ø–æ –ø—É–Ω–∫—Ç–∞—Ö (–¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –ø—Ä–æ–µ–∫—Ç—É)
